<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SMOKE HUB">
    <link rel="apple-touch-icon" href="https://files.catbox.moe/at907k.png">
    <link rel="icon" type="image/png" href="https://files.catbox.moe/at907k.png">
    
    <title>SMOKE HUB ADMIN</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    
    <style>
        body {
            margin: 0; font-family: 'Segoe UI', sans-serif;
            background: radial-gradient(circle at top, #1b0b2e, #0b0416);
            color: #fff; display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; padding-bottom: 50px;
            padding-top: env(safe-area-inset-top); 
        }
        .logo { display: flex; align-items: center; gap: 10px; margin: 15px 0; }
        .logo-text {
            font-weight: 900; font-size: 26px;
            background: linear-gradient(90deg, #ff0055, #00f2ff, #ff0055);
            background-size: 200% auto; -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; animation: gradient-move 3s linear infinite;
        }
        @keyframes gradient-move { to { background-position: 200% center; } }
        .card {
            width: 92%; max-width: 400px; padding: 20px; border-radius: 20px;
            background: rgba(255,255,255,0.07); backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1); box-sizing: border-box;
        }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .stat-box {
            background: rgba(0, 242, 255, 0.05); padding: 10px; border-radius: 12px; text-align: center;
            border: 1px solid rgba(0, 242, 255, 0.2);
        }
        .stat-box b { font-size: 22px; color: #fff; display: block; }
        .stat-box span { font-size: 10px; color: #00f2ff; text-transform: uppercase; }
        label { display: block; margin: 12px 0 5px; font-size: 10px; color: #00f2ff; font-weight: bold; }
        select, input {
            width: 100%; padding: 14px; border-radius: 12px; border: none; 
            background: rgba(255,255,255,0.1); color: #fff; font-size: 16px; outline: none; box-sizing: border-box;
        }
        .price-display { font-size: 36px; text-align: center; margin: 15px 0; font-weight: 900; text-shadow: 0 0 15px #ff0055; }
        .main-btn {
            width: 100%; padding: 18px; border-radius: 15px; border: none;
            background: linear-gradient(90deg, #ff2f92, #ff005d);
            color: #fff; font-weight: bold; font-size: 18px; cursor: pointer;
        }
        .order-row {
            background: rgba(255,255,255,0.04); padding: 14px; border-radius: 15px;
            margin-bottom: 8px; border-left: 4px solid #00f2ff;
            display: flex; justify-content: space-between; align-items: center; width: 92%; max-width: 400px;
        }
        .order-row.debt { border-left-color: #ff9800; background: rgba(255, 152, 0, 0.1); }
        .order-price { font-weight: bold; color: #ff2f92; }
        .del-btn { background: none; border: none; color: #444; cursor: pointer; font-size: 18px; }
    </style>
</head>
<body>

<div class="logo">
    <span style="font-size: 30px;">üéÖ</span><span class="logo-text">SMOKE HUB</span>
</div>

<div class="card">
    <div class="stats-grid">
        <div class="stat-box"><span>PLN</span><b id="totalPLN">0</b></div>
        <div class="stat-box"><span>UAH</span><b id="totalUAH">0</b></div>
    </div>

    <label>–ö–∞—Ç–∞–ª–æ–≥</label>
    <select id="catalog" onchange="updateFlavors()">
        <option value="–∑–∞–ª–∏–≤–∫–∞">–ó–ê–õ–ò–í–ö–ê üß™</option>
        <option value="–ø—Ä–æ–¥–∞–∂">–ü–†–û–î–ê–ñ üì¶</option>
    </select>

    <label>–°—Ç–∞—Ç—É—Å</label>
    <select id="status" onchange="toggleDebt()">
        <option value="paid">–û–ü–õ–ê–ß–ï–ù–û ‚úÖ</option>
        <option value="debt">–ë–û–†–ì üö©</option>
    </select>

    <div id="debtorBox" style="display: none;">
        <label>–•—Ç–æ –≤–∏–Ω–µ–Ω?</label>
        <input type="text" id="debtorName" placeholder="–Ü–º'—è">
    </div>

    <label>–û–ø–ª–∞—Ç–∞</label>
    <select id="pay" onchange="calc()">
        <option value="–ì–æ—Ç—ñ–≤–∫–∞">–ì–æ—Ç—ñ–≤–∫–∞ (PLN)</option>
        <option value="–ü–æ–ª—å—Å—å–∫–∞ –∫–∞—Ä—Ç–∞">–ü–æ–ª—å—Å—å–∫–∞ –∫–∞—Ä—Ç–∞ (PLN)</option>
        <option value="–ú–æ–Ω–æ–±–∞–Ω–∫">–ú–æ–Ω–æ–±–∞–Ω–∫ (UAH)</option>
    </select>

    <div id="volBox">
        <label>–û–±'—î–º</label>
        <select id="size" onchange="calc()">
            <option value="2">2 ml</option>
            <option value="3">3 ml</option>
        </select>
    </div>

    <label>–°–º–∞–∫</label>
    <select id="flavor" onchange="calc()"></select>

    <div class="price-display" id="total">6 –∑–ª</div>
    <button class="main-btn" onclick="save()">–ó–ë–ï–†–ï–ì–¢–ò</button>
</div>

<div id="debtList" style="width: 100%; display: flex; flex-direction: column; align-items: center; margin-top: 20px;"></div>
<div id="logs" style="width: 100%; display: flex; flex-direction: column; align-items: center; margin-top: 10px;"></div>

<script>
    // –¢–≤—ñ–π –≤—Å—Ç–∞–≤–ª–µ–Ω–∏–π –∫–æ–Ω—Ñ—ñ–≥
    const firebaseConfig = {
      apiKey: "AIzaSyAOW2GEW1McWRAzs4RLVOGHvcoAnRhgRC4",
      authDomain: "smokehub-7a072.firebaseapp.com",
      projectId: "smokehub-7a072",
      storageBucket: "smokehub-7a072.firebasestorage.app",
      messagingSenderId: "563107040578",
      appId: "1:563107040578:web:6379a7bc43bb7b58794cdb"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const flavors = ["spermint", "double grape", "apple mixed", "berry mint", "blackurant grape", "blueberry curant", "watermelon melon", "cranberry mors", "double raspberry", "Cola Lemon", "RedBull blue raspberry", "pineaple lemonade", "multifruit", "bali triple shot"];

    function updateFlavors() {
        const cat = document.getElementById('catalog').value;
        const sel = document.getElementById('flavor');
        const v = document.getElementById('volBox');
        sel.innerHTML = '';
        if(cat === '–ø—Ä–æ–¥–∞–∂') {
            sel.innerHTML += '<option value="ICE SHOT">ICE SHOT üßä</option>';
            flavors.forEach(f => sel.innerHTML += `<option value="${f} (30ml)">${f} (30ml)</option>`);
            v.style.display = 'none';
        } else {
            flavors.forEach(f => sel.innerHTML += `<option value="${f}">${f}</option>`);
            v.style.display = 'block';
        }
        calc();
    }

    function toggleDebt() { document.getElementById('debtorBox').style.display = document.getElementById('status').value === 'debt' ? 'block' : 'none'; }

    function calc() {
        const cat = document.getElementById('catalog').value;
        const p = document.getElementById('pay').value;
        const s = document.getElementById('size').value;
        const f = document.getElementById('flavor').value;
        const out = document.getElementById('total');
        
        if(cat === '–ø—Ä–æ–¥–∞–∂') {
            out.innerText = f === 'ICE SHOT' ? (p === '–ú–æ–Ω–æ–±–∞–Ω–∫' ? '110 –≥—Ä–Ω' : '10 –∑–ª') : (p === '–ú–æ–Ω–æ–±–∞–Ω–∫' ? '700 –≥—Ä–Ω' : '60 –∑–ª');
        } else {
            out.innerText = p === '–ú–æ–Ω–æ–±–∞–Ω–∫' ? (s === '2' ? '70 –≥—Ä–Ω' : '100 –≥—Ä–Ω') : (s === '2' ? '6 –∑–ª' : '9 –∑–ª');
        }
    }

    async function save() {
        const pStr = document.getElementById('total').innerText;
        const data = {
            catalog: document.getElementById('catalog').value,
            pay: document.getElementById('pay').value,
            flavor: document.getElementById('flavor').value,
            size: document.getElementById('catalog').value === '–ø—Ä–æ–¥–∞–∂' ? '30ml' : document.getElementById('size').value + 'ml',
            priceVal: parseInt(pStr),
            currency: pStr.includes('–≥—Ä–Ω') ? 'UAH' : 'PLN',
            fullPrice: pStr,
            status: document.getElementById('status').value,
            debtor: document.getElementById('debtorName').value || '',
            date: new Date().getTime()
        };
        await db.collection("orders").add(data);
        document.getElementById('debtorName').value = '';
    }

    db.collection("orders").orderBy("date", "desc").onSnapshot(snap => {
        let pln = 0, uah = 0;
        const l = document.getElementById('logs'); const d = document.getElementById('debtList');
        l.innerHTML = ''; d.innerHTML = '';
        snap.forEach(doc => {
            const i = doc.data();
            if(i.status === 'paid') {
                if(i.currency === 'PLN') pln += i.priceVal; else uah += i.priceVal;
                l.innerHTML += `<div class="order-row"><div><b>${i.flavor}</b><br><small>${i.pay}</small></div><div style="display:flex; align-items:center; gap:10px;"><span class="order-price">${i.fullPrice}</span><button class="del-btn" onclick="db.collection('orders').doc('${doc.id}').delete()">üóëÔ∏è</button></div></div>`;
            } else {
                d.innerHTML += `<div class="order-row debt"><div><b>${i.debtor}</b><br><small>${i.flavor}</small></div><div style="display:flex; align-items:center; gap:10px;"><span class="order-price">${i.fullPrice}</span><button style="background:#ff9800; border:none; border-radius:5px; padding:5px;" onclick="db.collection('orders').doc('${doc.id}').update({status:'paid'})">OK</button></div></div>`;
            }
        });
        document.getElementById('totalPLN').innerText = pln;
        document.getElementById('totalUAH').innerText = uah;
    });

    updateFlavors();
</script>
</body>
</html>
